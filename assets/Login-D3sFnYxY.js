import{_ as h,r as p,a as v,c as I,o as L,b as o,d as t,w as n,e as a,u as N,f as c,E as f}from"./index-NrR5gDLZ.js";import{a as B}from"./api-D5CWHRCG.js";const C={class:"login-page"},E={class:"login-container"},F={class:"login-form-container"},R={class:"form-options"},S={class:"form-footer"},U={__name:"Login",setup(q){const b=N(),u=p(null),m=p(!1),g=p(!1),r=v({phone_number:"",password:""}),w=v({phone_number:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入有效的11位手机号码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]}),V=async()=>{u.value&&await u.value.validate(async _=>{var e,i;if(_){m.value=!0;try{const s=await B.login(r);if(s.data.code===200){const l=s.data.data;localStorage.setItem("token",l.access_token),localStorage.setItem("user",JSON.stringify({userId:l.user_id,name:l.name,phone:l.phone_number})),f.success("登录成功"),b.push("/chat")}else f.error(s.data.message||"登录失败")}catch(s){f.error(((i=(e=s.response)==null?void 0:e.data)==null?void 0:i.message)||"登录出错，请稍后再试")}finally{m.value=!1}}})};return(_,e)=>{const i=a("el-input"),s=a("el-form-item"),l=a("el-checkbox"),k=a("el-button"),y=a("router-link"),x=a("el-form");return L(),I("div",C,[o("div",E,[e[9]||(e[9]=o("div",{class:"login-info"},[o("div",{class:"login-info-content"},[o("h1",{class:"system-name"},"博物馆知识问答系统"),o("p",{class:"system-desc"},"探索历史文化，发现艺术魅力")])],-1)),o("div",F,[e[8]||(e[8]=o("div",{class:"login-form-header"},[o("h2",null,"账号登录")],-1)),t(x,{ref_key:"loginFormRef",ref:u,model:r,rules:w,class:"login-form"},{default:n(()=>[t(s,{prop:"phone_number"},{default:n(()=>[t(i,{modelValue:r.phone_number,"onUpdate:modelValue":e[0]||(e[0]=d=>r.phone_number=d),placeholder:"请输入手机号","prefix-icon":"Phone"},null,8,["modelValue"])]),_:1}),t(s,{prop:"password"},{default:n(()=>[t(i,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=d=>r.password=d),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),o("div",R,[t(l,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=d=>g.value=d)},{default:n(()=>e[3]||(e[3]=[c("记住我")])),_:1},8,["modelValue"]),e[4]||(e[4]=o("a",{href:"javascript:void(0)",class:"forgot-password"},"忘记密码？",-1))]),t(s,null,{default:n(()=>[t(k,{type:"primary",loading:m.value,onClick:V,class:"login-button"},{default:n(()=>e[5]||(e[5]=[c(" 登录 ")])),_:1},8,["loading"])]),_:1}),o("div",S,[e[7]||(e[7]=o("span",null,"没有账号？",-1)),t(y,{to:"/register"},{default:n(()=>e[6]||(e[6]=[c("立即注册")])),_:1})])]),_:1},8,["model","rules"])])])])}}},A=h(U,[["__scopeId","data-v-d1ef26e1"]]);export{A as default};
